import random

def create_board():
    return [[' ' for _ in range(7)] for _ in range(6)]

def print_board(board):
    print("\n 0 1 2 3 4 5 6")
    for row in board:
        print('|' + '|'.join(row) + '|')
    print('-' * 15)

def is_valid_location(board, col):
    return board[0][col] == ' '

def get_next_open_row(board, col):
    for r in range(5, -1, -1):
        if board[r][col] == ' ':
            return r

def drop_piece(board, row, col, piece):
    board[row][col] = piece

def winning_move(board, piece):
    # Check horizontal locations
    for c in range(4):
        for r in range(6):
            if all([board[r][c+i] == piece for i in range(4)]):
                return True
    # Check vertical locations
    for c in range(7):
        for r in range(3):
            if all([board[r+i][c] == piece for i in range(4)]):
                return True
    # Check positively sloped diagonals
    for c in range(4):
        for r in range(3):
            if all([board[r+i][c+i] == piece for i in range(4)]):
                return True
    # Check negatively sloped diagonals
    for c in range(4):
        for r in range(3, 6):
            if all([board[r-i][c+i] == piece for i in range(4)]):
                return True
    return False

def is_board_full(board):
    return all(board[0][c] != ' ' for c in range(7))

def get_valid_locations(board):
    return [c for c in range(7) if is_valid_location(board, c)]

def ai_move(board):
    valid_locations = get_valid_locations(board)
    return random.choice(valid_locations)

def play_game():
    board = create_board()
    game_over = False
    turn = 0

    print("Welcome to 4 in a Row! You are 'X' and the AI is 'O'.")

    while not game_over:
        print_board(board)

        if turn % 2 == 0:
            # Player's turn
            piece = 'X'
            while True:
                try:
                    col = int(input("Your turn! Select a column (0-6): "))
                    if col < 0 or col > 6:
                        print("Invalid column. Try again.")
                        continue
                    if not is_valid_location(board, col):
                        print("Column is full. Choose another one.")
                        continue
                    break
                except ValueError:
                    print("Please enter a number between 0 and 6.")
            row = get_next_open_row(board, col)
            drop_piece(board, row, col, piece)

            if winning_move(board, piece):
                print_board(board)
                print("Congratulations! You win!")
                game_over = True
        else:
            # AI's turn
            piece = 'O'
            print("AI's turn...")
            col = ai_move(board)
            row = get_next_open_row(board, col)
            drop_piece(board, row, col, piece)

            if winning_move(board, piece):
                print_board(board)
                print("AI wins! Better luck next time.")
                game_over = True

        if is_board_full(board):
            print_board(board)
            print("It's a tie!")
            game_over = True

        turn += 1

    print("Game over!")

# Run the game
play_game()

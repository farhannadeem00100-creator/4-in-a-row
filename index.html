<!DOCTYPE html>
<html lang="en" class=""><head><script>window.livecodes = window.livecodes || {};</script><title>Untitled Project</title><meta name="title" content="Untitled Project"><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="./style.css"><script src="https://cdn.jsdelivr.net/npm/es-module-shims@1.10.0/dist/es-module-shims.js" async=""></script><script type="importmap">{
  "imports": {}
}</script></head><body>


<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>4 in a Row Game with AI</title>
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    margin-top: 20px;
  }
  h1 {
    margin-bottom: 10px;
  }
  #board {
    display: grid;
    grid-template-rows: repeat(6, 50px);
    grid-template-columns: repeat(7, 50px);
    gap: 5px;
    justify-content: center;
  }
  .cell {
    width: 50px;
    height: 50px;
    background-color: #ddd;
    border-radius: 50%;
    cursor: pointer;
    transition: background-color 0.3s;
  }
  .cell:hover {
    background-color: #bbb;
  }
  .red {
    background-color: red;
  }
  .yellow {
    background-color: yellow;
  }
  #message {
    margin-top: 20px;
    font-size: 1.2em;
  }
  button {
    margin-top: 20px;
    padding: 10px 20px;
    font-size: 1em;
  }
</style>



<h1>4 in a Row (Connect Four) with AI</h1>
<div id="board"></div>
<div id="message"></div>
<button onclick="restartGame()">Restart Game</button>

<script>
const rows = 6;
const cols = 7;
let currentPlayer = 'red'; // human starts
let gameActive = true;
let board = [];
const humanPlayer = 'red';
const aiPlayer = 'yellow';

// Initialize the game
function init() {
  board = Array.from({ length: rows }, () => Array(cols).fill(null));
  const boardDiv = document.getElementById('board');
  boardDiv.innerHTML = '';

  for (let r = 0; r < rows; r++) {
    for (let c = 0; c < cols; c++) {
      const cell = document.createElement('div');
      cell.className = 'cell';
      cell.dataset.row = r;
      cell.dataset.col = c;
      cell.addEventListener('click', handleCellClick);
      boardDiv.appendChild(cell);
    }
  }
  document.getElementById('message').textContent = `Your turn`;
  gameActive = true;
}

function handleCellClick(e) {
  if (!gameActive || currentPlayer !== humanPlayer) return;
  const col = parseInt(e.target.dataset.col);
  // Find the lowest empty row in this column
  for (let r = rows - 1; r >= 0; r--) {
    if (!board[r][col]) {
      makeMove(r, col, humanPlayer);
      if (checkWin(r, col, humanPlayer)) {
        document.getElementById('message').textContent = `You win!`;
        gameActive = false;
        return;
      }
      if (isDraw()) {
        document.getElementById('message').textContent = `It's a draw!`;
        gameActive = false;
        return;
      }
      currentPlayer = aiPlayer;
      document.getElementById('message').textContent = `AI's turn`;
      setTimeout(aiMove, 500); // slight delay for better UX
      return;
    }
  }
}

function makeMove(row, col, player) {
  board[row][col] = player;
  updateCell(row, col);
}

function updateCell(row, col) {
  const index = row * cols + col;
  const cell = document.querySelectorAll('.cell')[index];
  cell.className = 'cell ' + board[row][col];
}

function checkWin(row, col, player) {
  const directions = [
    { dr: 0, dc: 1 },   // horizontal
    { dr: 1, dc: 0 },   // vertical
    { dr: 1, dc: 1 },   // diagonal down
    { dr: 1, dc: -1 }   // diagonal up
  ];

  for (const { dr, dc } of directions) {
    let count = 1;
    count += countInDirection(row, col, dr, dc, player);
    count += countInDirection(row, col, -dr, -dc, player);
    if (count >= 4) return true;
  }
  return false;
}

function countInDirection(r, c, dr, dc, player) {
  let count = 0;
  r += dr;
  c += dc;
  while (
    r >= 0 && r < rows &&
    c >= 0 && c < cols &&
    board[r][c] === player
  ) {
    count++;
    r += dr;
    c += dc;
  }
  return count;
}

function isDraw() {
  return board.every(row => row.every(cell => cell !== null));
}

function restartGame() {
  currentPlayer = humanPlayer;
  init();
}

function aiMove() {
  if (!gameActive) return;
  // AI logic: try to win, block player, or pick best move
  const col = getBestMove();
  if (col === -1) return; // no move possible (should not happen in normal game)
  // Find the lowest empty row in that column
  for (let r = rows - 1; r >= 0; r--) {
    if (!board[r][col]) {
      makeMove(r, col, aiPlayer);
      if (checkWin(r, col, aiPlayer)) {
        document.getElementById('message').textContent = `AI wins!`;
        gameActive = false;
        return;
      }
      if (isDraw()) {
        document.getElementById('message').textContent = `It's a draw!`;
        gameActive = false;
        return;
      }
      currentPlayer = humanPlayer;
      document.getElementById('message').textContent = `Your turn`;
      return;
    }
  }
}

// AI logic: evaluate best move
function getBestMove() {
  // First, check if AI can win in next move
  for (let c = 0; c < cols; c++) {
    const r = getAvailableRow(c);
    if (r !== -1) {
      board[r][c] = aiPlayer;
      if (checkWin(r, c, aiPlayer)) {
        board[r][c] = null;
        return c;
      }
      board[r][c] = null;
    }
  }
  // Then, check if player can win in next move, block it
  for (let c = 0; c < cols; c++) {
    const r = getAvailableRow(c);
    if (r !== -1) {
      board[r][c] = humanPlayer;
      if (checkWin(r, c, humanPlayer)) {
        board[r][c] = null;
        return c;
      }
      board[r][c] = null;
    }
  }
  // Otherwise, pick the middle column or a random one
  const preferredCols = [3, 2, 4, 1, 5, 0, 6];
  for (let c of preferredCols) {
    if (getAvailableRow(c) !== -1) return c;
  }
  return -1; // no move found
}

// Helper to find available row in a column
function getAvailableRow(col) {
  for (let r = rows - 1; r >= 0; r--) {
    if (!board[r][col]) return r;
  }
  return -1;
}

// Initialize the game
init();
</script>


<script src="./script.js"></script></body></html>